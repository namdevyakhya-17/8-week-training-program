import java.util.*;
import java.io.*;

public class hwiSeven {
    static int[] parent;
    static int[] size;
    static HashMap<Integer, HashSet<Integer>> componentMap = new HashMap<>();
    static HashMap<Integer, Integer> componentBeauty = new HashMap<>();
    public static void init(int n){
        parent = new int[n+1];
        size = new int[n+1];
        for(int i=1; i<=n; i++){
            parent[i] = i;
            size[i] = 1;
            HashSet<Integer> set = new HashSet<>();
            set.add(i);   // all are already stores in their own size
            componentMap.put(i,set);
            componentBeauty.put(i,1);  // initially all elements as disjoint, having beauty as 1 only
        }
    }

    public static int find(int x){
        if(x == parent[x]) return x;
        return parent[x] = find(parent[x]);
    }

    public static void union(int x, int y){
        int par_x = find(x);
        int par_y = find(y);
        if(size[par_x]<size[par_y])
        {
            int tmp = par_x;
            par_x = par_y;
            par_y=tmp;
        }
        parent[par_y]=par_x;
        size[par_x]+=size[par_y];
        return;
    }

    public static void main(String[] args) throws Exception{
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine());
        int n = Integer.parseInt(st.nextToken());
        int q = Integer.parseInt(st.nextToken());
        int t = Integer.parseInt(st.nextToken());

        long totalBeauty = 0;        
        init(n);
        while(q-- > 0){
            st = new StringTokenizer(br.readLine());
            int type = Integer.parseInt(st.nextToken());
            int u = Integer.parseInt(st.nextToken());
            int v = Integer.parseInt(st.nextToken());
            if(type == 1){  
                int par_u = find(u);
                int par_v = find(v);
                if(par_u == par_v) continue; 
                union(u,v);                
                HashSet<Integer> big = componentMap.get(par_u);
                // System.out.println(big);
                HashSet<Integer> small = componentMap.get(par_v);
                // System.out.println(small);
                int beautyBig = componentBeauty.get(par_u);
                for(int node: small){
                    // checking if left(-1) and right(+1) node of node is available in bis or not
                    boolean left = big.contains(node-1);
                    boolean right = big.contains(node+1);
                    if(left&&right) beautyBig--;   // case 1
                    else if(!left && ! right) beautyBig++; // case 2
                    
                    big.add(node);
                }
                componentMap.put(par_u,big);
                componentBeauty.put(par_u,beautyBig);
                componentBeauty.remove(par_v);
            }
            if(type == 2){
                int par_u = find(u);
                // System.out.println(par_u);
                int beauty_u = componentBeauty.get(par_u);
                totalBeauty += beauty_u;
            }
        }
        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));
        bw.write(totalBeauty+" ");
        bw.flush();
    }
}
