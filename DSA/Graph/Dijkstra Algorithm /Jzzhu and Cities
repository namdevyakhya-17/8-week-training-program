import java.io.*;
import java.util.*;

public class JzzhuandCities {
    static class Pair{
        int dest;
        long len;
        int state;
        public Pair(int dest, long len, int state){
            this.dest = dest;
            this.len = len;
            this.state = state;
        }
    }
    public static void main(String[] args) throws Exception{
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        StringTokenizer st = new StringTokenizer(br.readLine());
        
        int n = Integer.parseInt(st.nextToken());
        int m = Integer.parseInt(st.nextToken());
        int k = Integer.parseInt(st.nextToken());
        ArrayList<ArrayList<Pair>> graph = new ArrayList<>();
        for(int i=0; i<=n; i++){
            graph.add(new ArrayList<>());
        }

        for(int i=0; i<m; i++){
            st = new StringTokenizer(br.readLine());
            int u = Integer.parseInt(st.nextToken());
            int v = Integer.parseInt(st.nextToken());
            int wt = Integer.parseInt(st.nextToken());
            graph.get(u).add(new Pair(v, wt,0));
            graph.get(v).add(new Pair(u, wt, 0));
        }

        PriorityQueue<long[]> q = new PriorityQueue<>((a,b) -> Long.compare(a[1], b[1]));
        long[] cost = new long[n+1];
        Arrays.fill(cost, Long.MAX_VALUE);

        for(int i=0; i<k; i++){
            st = new StringTokenizer(br.readLine());
            int v = Integer.parseInt(st.nextToken());
            int wt = Integer.parseInt(st.nextToken());
            graph.get(1).add(new Pair(v,wt, 1));
        }

        q.add(new long[]{1,0});
        cost[1] = 0;
        boolean[] train = new boolean[n+1];
        while (!q.isEmpty()) {
            long[] cur = q.poll();
            int v = (int) cur[0];
            long wt = cur[1];

            if(cost[v]< wt) continue;
            for(Pair p : graph.get(v)){
                int des = p.dest;
                long l = p.len;
                int state = p.state;
                long newCost = wt+l;
                if(newCost < cost[des]){
                    cost[des] = newCost;
                    train[des] = (state == 1);
                    q.add(new long[]{des,newCost});
                }else if(newCost == cost[des] && state == 0){
                    train[des] = false;
                }
            }
        }

        BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(System.out));

        int count = 0;
        for(boolean used: train){
            if(used) count++; 
        }
        bw.write(k-count+" ");
        bw.flush();
    }
}
